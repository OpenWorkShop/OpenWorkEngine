
fragment MachineLogEntryConnection on MachineLogEntryConnection {
    edges {
        cursor
        node {
            ...MachineLogEntry
        }
    }
    nodes {
        ...MachineLogEntry
    }
    pageInfo {
        ...PageInfo
    }
}

fragment MachineTimelineNodeConnection on MachineTimelineNodeConnection {
    edges {
        cursor
        node {
            ...MachineTimelineNode
        }
    }
    nodes {
        ...MachineTimelineNode
    }
    pageInfo {
        ...PageInfo
    }
}

fragment PageInfo on PageInfo {
    startCursor
    endCursor
    hasNextPage
    hasPreviousPage
}

fragment MachineTimelineNode on MachineTimelineNode {
    logLevel
    logEntries { ...MachineLogEntry }
}

fragment MachineLogEntry on MachineLogEntry {
    id
    timestamp
    count
    message
    logLevel
    source
    writeState
    error {
        ...MachineAlert
    }
    code {
        ...SyntaxChunk
    }
}

fragment MachineLogs on ControlledMachine {
    logs(first: 50, order: { timestamp: DESC }) {
        ...MachineLogEntryConnection
    }
    timeline(first: 50) {
        ...MachineTimelineNodeConnection
    }
}

subscription MachineLogs($portName: String!) {
    machine: onMachineLog(portName: $portName) {
        topicId
        ...MachineLogs
    }
}